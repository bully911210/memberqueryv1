function doGet(e) {
  // Create response object and set content type to JSON
  var response = ContentService.createTextOutput();
  response.setMimeType(ContentService.MimeType.JSON);

  // Enable CORS - Allow any origin (you can specify your domain for more security)
  response.addHeader("Access-Control-Allow-Origin", "*"); // You can replace '*' with your domain like 'https://member-checker.onrender.com'
  response.addHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
  response.addHeader("Access-Control-Allow-Headers", "Content-Type");

  // Allow OPTIONS preflight request
  if (e && e.parameter && e.parameter.query === undefined) {
    return response;
  }

  // Get the query parameter (the value entered in the search input)
  var query = e.parameter.query;

  // Replace with your actual Google Sheet ID and sheet name
  var sheet = SpreadsheetApp.openById('1G-_SbkSc7YYkBy7dFkGlFERkK6IJNt78hVGCIrsYeW4/').getSheetByName('SIGS Sales Data - 2024 - 2025'); // Replace 'YOUR_SHEET_ID' and 'Sheet1' with your actual Sheet ID and name
  var data = sheet.getDataRange().getValues();  // Fetch all the data from the sheet

  var filteredData = [];
  
  // Filter data based on the query (assuming the query matches the first column)
  // Modify the filter logic based on your actual sheet's structure
  data.forEach(function(row) {
    if (row[0].toString() === query) {  // Modify the condition based on your column structure
      filteredData.push({
        "Agent Name": row[1],  // Assuming column 1 contains the agent name
        "Client Name": row[2],  // Assuming column 2 contains the client name
        "Client Email": row[3], // Assuming column 3 contains the client email
        "Client Phone Number": row[4], // Assuming column 4 contains the client phone number
        "Monthly Premium": row[5], // Assuming column 5 contains the monthly premium
        "Annual Premium": row[6], // Assuming column 6 contains the annual premium
        "Client ID Number": row[7], // Assuming column 7 contains the client ID
        "Street Address": row[8], // Assuming column 8 contains the street address
        "Suburb": row[9], // Assuming column 9 contains the suburb
        "City/Town": row[10], // Assuming column 10 contains the city/town
        "Province": row[11], // Assuming column 11 contains the province
        "Postal Code": row[12] // Assuming column 12 contains the postal code
      });
    }
  });

  // Return the filtered data as a JSON response
  return response.setContent(JSON.stringify(filteredData));
}

function doPost(e) {
  // This function can be used for POST requests if needed (similar to doGet).
  // If you're not using POST requests, you can skip or modify this part.
}
